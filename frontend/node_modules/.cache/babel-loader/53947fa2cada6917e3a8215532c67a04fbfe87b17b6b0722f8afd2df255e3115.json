{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useRef,useState}from\"react\";import Button from\"./button\";import Text from\"./texts\";import UploadMedia from\"./uploadImage\";import Web2Metadata from\"./web2Metadata\";import Web3Metadata from\"./web3Metadata\";import{web2_form,web3_form}from\"./form\";import{uploadToIpfsAndServer}from\"../api/api\";import{toast}from\"react-toastify\";import{UserContext}from\"../contexts/user.contexts\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CreateVault(_ref){var setSection=_ref.setSection;var _useContext=useContext(UserContext),account=_useContext.account;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),imageFile=_useState2[0],setImageFile=_useState2[1];var _useState3=useState(_objectSpread({},web2_form)),_useState4=_slicedToArray(_useState3,2),web2Form=_useState4[0],setWeb2Form=_useState4[1];var _useState5=useState(_objectSpread({},web3_form)),_useState6=_slicedToArray(_useState5,2),web3Form=_useState6[0],setWeb3Form=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),error=_useState8[0],setError=_useState8[1];var errors=useRef(_objectSpread({},web3_form));var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),stage=_useState10[0],setStage=_useState10[1];function next(){if(stage==0&&!imageFile){return;}stage<2&&setStage(stage+1);}function back(){stage>0&&setStage(stage-1);}useEffect(function(){// console.log(imageFile);\n},[imageFile]);function upload(){var _errors=Object.values(web3Form);if(_errors.includes(\"\")||!imageFile){setError(true);return;}toast.promise(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return uploadToIpfsAndServer(imageFile,web3Form.name,web3Form.description,account,web2Form);case 3:_context.next=9;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);console.log(_context.t0);throw _context.t0;case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,5]]);})),{pending:\"Uploading Vault\",success:{render:function render(_ref3){var data=_ref3.data;setSection(0);return\"Uploaded Successfully\";}},error:{render:function render(_ref4){var data=_ref4.data;return\"Oops! failed.\";}}});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{size:\"lg\",cls:\"font-semibold\",children:\"Create New Vault\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center w-fit mx-auto my-10\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rounded-xl \".concat(stage>=0?\"bg-theme-red h-[20px] w-[20px]\":\"bg-theme-grey h-[15px] w-[15px]\",\" relative\"),style:{transition:\"all 0.2s ease-in\"}}),/*#__PURE__*/_jsx(Text,{cls:\"absolute bottom-[-30px] text-[12px] w-[100px] \".concat(stage>=0?\"text-theme-red font-bold\":\"\"),children:\"Upload Media\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-[200px] h-[3px] bg-theme-\".concat(stage>=1?\"red\":\"grey\"),style:{transition:\"all 0.2s ease-in\"}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rounded-xl \".concat(stage>=1?\"bg-theme-red h-[20px] w-[20px]\":\"bg-theme-grey h-[15px] w-[15px]\",\" relative\"),style:{transition:\"all 0.2s ease-in\"}}),/*#__PURE__*/_jsx(Text,{cls:\"absolute bottom-[-30px] text-[12px] w-[100px] \".concat(stage>=1?\"text-theme-red font-bold\":\"\"),children:\"Web2 Metadata\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-[200px] h-[3px] bg-theme-\".concat(stage>=2?\"red\":\"grey\"),style:{transition:\"all 0.2s ease-in\"}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center relative\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rounded-xl \".concat(stage>=2?\"bg-theme-red h-[20px] w-[20px]\":\"bg-theme-grey h-[15px] w-[15px]\",\" relative\"),style:{transition:\"all 0.2s ease-in\"}}),/*#__PURE__*/_jsx(Text,{cls:\"absolute bottom-[-30px] text-[12px] w-[100px] \".concat(stage>=2?\"text-theme-red font-bold\":\"\"),children:\"Web3 Metadata\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-[360px] mx-auto my-[100px]\",children:[stage==0&&/*#__PURE__*/_jsx(UploadMedia,{setImageFile:setImageFile,imageFile:imageFile}),stage==1&&/*#__PURE__*/_jsx(Web2Metadata,{form:web2Form,setForm:setWeb2Form}),stage==2&&/*#__PURE__*/_jsx(Web3Metadata,{form:web3Form,setForm:setWeb3Form,errors:errors,error:error})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between w-[260px] m-auto\",children:[stage>0&&/*#__PURE__*/_jsx(Button,{label:\"Back\",onClick:back}),stage<2&&/*#__PURE__*/_jsx(Button,{label:\"Next\",onClick:next,cls:\"ml-auto\"}),stage==2&&/*#__PURE__*/_jsx(Button,{label:\"Submit\",onClick:upload})]})]});}","map":{"version":3,"names":["React","useContext","useEffect","useRef","useState","Button","Text","UploadMedia","Web2Metadata","Web3Metadata","web2_form","web3_form","uploadToIpfsAndServer","toast","UserContext","CreateVault","setSection","account","imageFile","setImageFile","web2Form","setWeb2Form","web3Form","setWeb3Form","error","setError","errors","stage","setStage","next","back","upload","_errors","Object","values","includes","promise","name","description","console","log","pending","success","render","data","transition"],"sources":["/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/src/components/createVault.jsx"],"sourcesContent":["import React, { useContext, useEffect, useRef, useState } from \"react\";\nimport Button from \"./button\";\nimport Text from \"./texts\";\nimport UploadMedia from \"./uploadImage\";\nimport Web2Metadata from \"./web2Metadata\";\nimport Web3Metadata from \"./web3Metadata\";\nimport { web2_form, web3_form } from \"./form\";\nimport { uploadToIpfsAndServer } from \"../api/api\";\nimport { toast } from \"react-toastify\";\nimport { UserContext } from \"../contexts/user.contexts\";\n\nexport default function CreateVault({ setSection }) {\n  const { account } = useContext(UserContext);\n  const [imageFile, setImageFile] = useState(null);\n  const [web2Form, setWeb2Form] = useState({ ...web2_form });\n  const [web3Form, setWeb3Form] = useState({ ...web3_form });\n  const [error, setError] = useState(false);\n  const errors = useRef({ ...web3_form });\n  const [stage, setStage] = useState(0);\n\n  function next() {\n    if (stage == 0 && !imageFile) {\n      return;\n    }\n    stage < 2 && setStage(stage + 1);\n  }\n\n  function back() {\n    stage > 0 && setStage(stage - 1);\n  }\n\n  useEffect(() => {\n    // console.log(imageFile);\n  }, [imageFile]);\n\n  function upload() {\n    let _errors = Object.values(web3Form);\n    if (_errors.includes(\"\") || !imageFile) {\n      setError(true);\n      return;\n    }\n    toast.promise(\n      async () => {\n        try {\n          await uploadToIpfsAndServer(\n            imageFile,\n            web3Form.name,\n            web3Form.description,\n            account,\n            web2Form\n          );\n        } catch (error) {\n          console.log(error);\n          throw error;\n        }\n      },\n      {\n        pending: \"Uploading Vault\",\n        success: {\n          render({ data }) {\n            setSection(0);\n            return `Uploaded Successfully`;\n          },\n        },\n        error: {\n          render({ data }) {\n            return \"Oops! failed.\";\n          },\n        },\n      }\n    );\n  }\n\n  return (\n    <div>\n      <Text size={\"lg\"} cls={\"font-semibold\"}>\n        Create New Vault\n      </Text>\n\n      <div className=\"flex items-center w-fit mx-auto my-10\">\n        <div className=\"flex flex-col items-center justify-center relative\">\n          <div\n            className={`rounded-xl ${\n              stage >= 0\n                ? \"bg-theme-red h-[20px] w-[20px]\"\n                : \"bg-theme-grey h-[15px] w-[15px]\"\n            } relative`}\n            style={{\n              transition: \"all 0.2s ease-in\",\n            }}\n          ></div>\n          <Text\n            cls={`absolute bottom-[-30px] text-[12px] w-[100px] ${\n              stage >= 0 ? \"text-theme-red font-bold\" : \"\"\n            }`}\n          >\n            Upload Media\n          </Text>\n        </div>\n        <div\n          className={`w-[200px] h-[3px] bg-theme-${\n            stage >= 1 ? \"red\" : \"grey\"\n          }`}\n          style={{\n            transition: \"all 0.2s ease-in\",\n          }}\n        ></div>\n        <div className=\"flex flex-col items-center relative\">\n          <div\n            className={`rounded-xl ${\n              stage >= 1\n                ? \"bg-theme-red h-[20px] w-[20px]\"\n                : \"bg-theme-grey h-[15px] w-[15px]\"\n            } relative`}\n            style={{\n              transition: \"all 0.2s ease-in\",\n            }}\n          ></div>\n          <Text\n            cls={`absolute bottom-[-30px] text-[12px] w-[100px] ${\n              stage >= 1 ? \"text-theme-red font-bold\" : \"\"\n            }`}\n          >\n            Web2 Metadata\n          </Text>\n        </div>\n        <div\n          className={`w-[200px] h-[3px] bg-theme-${\n            stage >= 2 ? \"red\" : \"grey\"\n          }`}\n          style={{\n            transition: \"all 0.2s ease-in\",\n          }}\n        ></div>\n        <div className=\"flex flex-col items-center relative\">\n          <div\n            className={`rounded-xl ${\n              stage >= 2\n                ? \"bg-theme-red h-[20px] w-[20px]\"\n                : \"bg-theme-grey h-[15px] w-[15px]\"\n            } relative`}\n            style={{\n              transition: \"all 0.2s ease-in\",\n            }}\n          ></div>\n          <Text\n            cls={`absolute bottom-[-30px] text-[12px] w-[100px] ${\n              stage >= 2 ? \"text-theme-red font-bold\" : \"\"\n            }`}\n          >\n            Web3 Metadata\n          </Text>\n        </div>\n      </div>\n\n      <div className=\"w-[360px] mx-auto my-[100px]\">\n        {stage == 0 && (\n          <UploadMedia setImageFile={setImageFile} imageFile={imageFile} />\n        )}\n        {stage == 1 && <Web2Metadata form={web2Form} setForm={setWeb2Form} />}\n        {stage == 2 && (\n          <Web3Metadata\n            form={web3Form}\n            setForm={setWeb3Form}\n            errors={errors}\n            error={error}\n          />\n        )}\n      </div>\n\n      <div className=\"flex justify-between w-[260px] m-auto\">\n        {stage > 0 && <Button label={\"Back\"} onClick={back} />}\n        {stage < 2 && <Button label={\"Next\"} onClick={next} cls={\"ml-auto\"} />}\n        {stage == 2 && <Button label={\"Submit\"} onClick={upload} />}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}