{"ast":null,"code":"import _objectSpread from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from\"react\";import Chart from\"../assets/chart.svg\";import Text from\"./texts\";import Track_1 from\"../assets/track_1.svg\";import{toast}from\"react-toastify\";import{endPoint,getMetadata,getVaults,parseUrl}from\"../api/api\";import{UserContext}from\"../contexts/user.contexts\";import Button from\"./button\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Dashboard(_ref){var account=_ref.account,setSection=_ref.setSection;var _useContext=useContext(UserContext),vaults=_useContext.vaults,setVaults=_useContext.setVaults;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loaded=_useState2[0],load=_useState2[1];function loadVaults(){toast.promise(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return getVaults(account);case 3:return _context.abrupt(\"return\",_context.sent);case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);console.log(_context.t0);throw _context.t0;case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);})),{pending:\"Loading your Vaults\",success:{render:function render(_ref3){var data=_ref3.data;console.log(data);setVaults(data.metadatas);return\"Success!\";}},error:{render:function render(_ref4){var data=_ref4.data;return\"Oops! Something went wrong\";}}});}useEffect(function(){if(!loaded){load(true);return;}loadVaults();},[loaded]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center w-fit ml-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Text,{cls:\"text-[11px]\",children:\"Total Streams\"}),/*#__PURE__*/_jsx(Text,{cls:\"font-bold\",children:\"120,000\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-theme-red w-fit h-[25px] rounded p-1 relative ml-3\",children:/*#__PURE__*/_jsx(\"img\",{src:Chart,className:\"h-[100%]\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-5\",children:/*#__PURE__*/_jsx(Text,{size:\"lg\",cls:\"font-bold\",children:\"TRACKS\"})}),/*#__PURE__*/_jsx(\"div\",{children:vaults&&vaults.map(function(vault,index){return/*#__PURE__*/_jsx(Track,{title:vault.mediaTitle,desc:vault.description,link:vault.ipfsUrl,id:vault._id,streams:vault.streamCount},index);})})]})]});}function Track(_ref5){var streams=_ref5.streams,link=_ref5.link,id=_ref5.id;var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),metadata=_useState4[0],setMetadata=_useState4[1];var _useContext2=useContext(UserContext),setPrev=_useContext2.setPrev,setSection=_useContext2.setSection;function preview(){setPrev(_objectSpread(_objectSpread({},metadata),{},{streams:streams,link:\"\".concat(endPoint,\"/metadata/\").concat(id)}));setSection(1);}useEffect(function(){getMetadata(link,id).then(function(meta){console.log(meta);setMetadata(meta);});},[]);if(!metadata)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"my-4 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center w-[40%] min-w-[500px] justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"video\",{src:metadata.video,autoPlay:true,controls:true,className:\"h-[100px]\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-[200px] h-[100px] flex flex-col justify-between\",children:[/*#__PURE__*/_jsx(Text,{size:\"md\",cls:\"font-bold\",children:metadata.name}),/*#__PURE__*/_jsxs(Text,{cls:\"text-[11px]\",children:[/*#__PURE__*/_jsx(Text,{cls:\"font-bold\",children:\"Description\"}),metadata.description]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsx(Text,{size:\"lg\",cls:\"font-bold\",children:streams}),/*#__PURE__*/_jsx(Text,{cls:\"font-semibold\",children:\"streams\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Button,{label:\"preview\",cls:\"h-fit mr-10\",onClick:preview}),/*#__PURE__*/_jsx(Text,{cls:\"text-12px underline\",onClick:function onClick(){navigator.clipboard.writeText(\"\".concat(endPoint,\"/metadata/\").concat(id));toast(\"copied\");},children:\"copy link\"})]})]});}","map":{"version":3,"names":["React","useContext","useEffect","useState","Chart","Text","Track_1","toast","endPoint","getMetadata","getVaults","parseUrl","UserContext","Button","Dashboard","account","setSection","vaults","setVaults","loaded","load","loadVaults","promise","console","log","pending","success","render","data","metadatas","error","map","vault","index","mediaTitle","description","ipfsUrl","_id","streamCount","Track","streams","link","id","metadata","setMetadata","setPrev","preview","then","meta","video","name","navigator","clipboard","writeText"],"sources":["/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/src/components/dashboard.jsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport Chart from \"../assets/chart.svg\";\nimport Text from \"./texts\";\nimport Track_1 from \"../assets/track_1.svg\";\nimport { toast } from \"react-toastify\";\nimport { endPoint, getMetadata, getVaults, parseUrl } from \"../api/api\";\nimport { UserContext } from \"../contexts/user.contexts\";\nimport Button from \"./button\";\n\nexport default function Dashboard({ account, setSection }) {\n  const { vaults, setVaults } = useContext(UserContext);\n  const [loaded, load] = useState(false);\n\n  function loadVaults() {\n    toast.promise(\n      async () => {\n        try {\n          return await getVaults(account);\n        } catch (error) {\n          console.log(error);\n          throw error;\n        }\n      },\n      {\n        pending: \"Loading your Vaults\",\n        success: {\n          render({ data }) {\n            console.log(data);\n            setVaults(data.metadatas);\n            return `Success!`;\n          },\n        },\n        error: {\n          render({ data }) {\n            return \"Oops! Something went wrong\";\n          },\n        },\n      }\n    );\n  }\n\n  useEffect(() => {\n    if (!loaded) {\n      load(true);\n      return;\n    }\n    loadVaults();\n  }, [loaded]);\n\n  return (\n    <div>\n      <div className=\"flex\">\n        <div className=\"flex items-center w-fit ml-auto\">\n          <div>\n            <Text cls={`text-[11px]`}>Total Streams</Text>\n            <Text cls={`font-bold`}>120,000</Text>\n          </div>\n          <div className=\"bg-theme-red w-fit h-[25px] rounded p-1 relative ml-3\">\n            <img src={Chart} className={`h-[100%]`} />\n          </div>\n        </div>\n      </div>\n\n      <div>\n        <div className=\"mb-5\">\n          <Text size={\"lg\"} cls={\"font-bold\"}>\n            TRACKS\n          </Text>\n        </div>\n        <div>\n          {vaults &&\n            vaults.map((vault, index) => (\n              <Track\n                title={vault.mediaTitle}\n                desc={vault.description}\n                link={vault.ipfsUrl}\n                key={index}\n                id={vault._id}\n                streams={vault.streamCount}\n              />\n            ))}\n          {/* <Track />\n          <Track />\n          <Track /> */}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction Track({ streams, link, id }) {\n  const [metadata, setMetadata] = useState(null);\n  const { setPrev, setSection } = useContext(UserContext);\n\n  function preview() {\n    setPrev({ ...metadata, streams, link: `${endPoint}/metadata/${id}` });\n    setSection(1);\n  }\n\n  useEffect(() => {\n    getMetadata(link, id).then((meta) => {\n      console.log(meta);\n      setMetadata(meta);\n    });\n  }, []);\n\n  if (!metadata) return null;\n\n  return (\n    <div className=\"my-4 flex justify-between items-center\">\n      <div className=\"flex items-center w-[40%] min-w-[500px] justify-between\">\n        <div>\n          <video\n            src={metadata.video}\n            autoPlay\n            controls\n            className={`h-[100px]`}\n          ></video>\n        </div>\n\n        <div className=\"w-[200px] h-[100px] flex flex-col justify-between\">\n          <Text size={\"md\"} cls={`font-bold`}>\n            {metadata.name}\n          </Text>\n\n          <Text cls={\"text-[11px]\"}>\n            <Text cls={\"font-bold\"}>Description</Text>\n            {metadata.description}\n          </Text>\n        </div>\n\n        <div className=\"flex flex-col items-center\">\n          <Text size={\"lg\"} cls={\"font-bold\"}>\n            {streams}\n          </Text>\n          <Text cls={`font-semibold`}>streams</Text>\n        </div>\n      </div>\n\n      <div className=\"flex items-center\">\n        <Button label={\"preview\"} cls={\"h-fit mr-10\"} onClick={preview} />\n        <Text\n          cls={\"text-12px underline\"}\n          onClick={() => {\n            navigator.clipboard.writeText(`${endPoint}/metadata/${id}`);\n            toast(\"copied\");\n          }}\n        >\n          copy link\n        </Text>\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}