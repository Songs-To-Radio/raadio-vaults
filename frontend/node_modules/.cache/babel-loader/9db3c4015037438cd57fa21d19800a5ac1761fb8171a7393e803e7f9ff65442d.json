{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{createContext,useState,useCallback,useEffect}from\"react\";import{ethers}from\"ethers\";import{getUser}from\"../api/api\";import{jsx as _jsx}from\"react/jsx-runtime\";export var UserContext=/*#__PURE__*/createContext();export default function UserContextProvider(_ref){var children=_ref.children;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),account=_useState2[0],setAccount=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),vaults=_useState4[0],setVaults=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),prev=_useState8[0],setPrev=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),section=_useState10[0],setSection=_useState10[1];var handleConnect=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var provider,accounts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:provider=new ethers.providers.Web3Provider(window.ethereum);_context.next=3;return provider.send(\"eth_requestAccounts\",[]);case 3:accounts=_context.sent;setAccount(accounts[0]);case 5:case\"end\":return _context.stop();}}},_callee);}));return function handleConnect(){return _ref2.apply(this,arguments);};}();var handleDisonnect=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setAccount(\"\");case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function handleDisonnect(){return _ref3.apply(this,arguments);};}();useEffect(function(){handleConnect();window.ethereum.on(\"accountsChanged\",/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(accounts){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setAccount(accounts[0]);case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x){return _ref4.apply(this,arguments);};}());},[]);useEffect(function(){console.log(account);account&&getUser(account).then(function(data){console.log(data);setUser(data.user);setVaults(data.metadatas);});},[account]);return/*#__PURE__*/_jsx(UserContext.Provider,{value:{account:account,handleConnect:handleConnect,handleDisonnect:handleDisonnect,vaults:vaults,setVaults:setVaults,user:user,setUser:setUser,prev:prev,setPrev:setPrev,section:section,setSection:setSection},children:children});}","map":{"version":3,"names":["createContext","useState","useCallback","useEffect","ethers","getUser","UserContext","UserContextProvider","children","account","setAccount","vaults","setVaults","user","setUser","prev","setPrev","section","setSection","handleConnect","provider","providers","Web3Provider","window","ethereum","send","accounts","handleDisonnect","on","console","log","then","data","metadatas"],"sources":["/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/src/contexts/user.contexts.jsx"],"sourcesContent":["import { createContext, useState, useCallback, useEffect } from \"react\";\nimport { ethers } from \"ethers\";\nimport { getUser } from \"../api/api\";\n\nexport const UserContext = createContext();\n\nexport default function UserContextProvider({children}){\n    const [account, setAccount] = useState(\"\");\n    const [vaults, setVaults] = useState(null);\n    const [user, setUser] = useState(null);\n    const [prev, setPrev] = useState(null);\n    const [section, setSection] = useState(0);\n\n    const handleConnect = async () => {\n        const provider = new ethers.providers.Web3Provider(window.ethereum)\n        const accounts = await provider.send(\"eth_requestAccounts\", [])\n        setAccount(accounts[0])\n    }\n    \n      const handleDisonnect = async () => {\n        setAccount(\"\");\n      }\n    \n      useEffect(() => {\n        handleConnect();\n        window.ethereum.on(\"accountsChanged\", async (accounts) => {\n          setAccount(accounts[0])\n        })\n      }, []);\n\n      useEffect(()=>{\n        console.log(account)\n        account && getUser(account)\n        .then((data)=>{\n            console.log(data);\n            setUser(data.user);\n            setVaults(data.metadatas);\n        })\n      }, [account]);\n    \n\n    return (\n        <UserContext.Provider value={{account, handleConnect, handleDisonnect, vaults, setVaults, user, setUser, prev, setPrev, section, setSection}}>\n            {children}\n        </UserContext.Provider>\n    )\n}"],"mappings":"4cAAA,OAASA,aAAa,CAAEC,QAAQ,CAAEC,WAAW,CAAEC,SAAS,KAAQ,OAAO,CACvE,OAASC,MAAM,KAAQ,QAAQ,CAC/B,OAASC,OAAO,KAAQ,YAAY,CAAC,2CAErC,MAAO,IAAMC,YAAW,cAAGN,aAAa,EAAE,CAE1C,cAAe,SAASO,oBAAmB,MAAY,IAAVC,SAAQ,MAARA,QAAQ,CACjD,cAA8BP,QAAQ,CAAC,EAAE,CAAC,wCAAnCQ,OAAO,eAAEC,UAAU,eAC1B,eAA4BT,QAAQ,CAAC,IAAI,CAAC,yCAAnCU,MAAM,eAAEC,SAAS,eACxB,eAAwBX,QAAQ,CAAC,IAAI,CAAC,yCAA/BY,IAAI,eAAEC,OAAO,eACpB,eAAwBb,QAAQ,CAAC,IAAI,CAAC,yCAA/Bc,IAAI,eAAEC,OAAO,eACpB,eAA8Bf,QAAQ,CAAC,CAAC,CAAC,0CAAlCgB,OAAO,gBAAEC,UAAU,gBAE1B,GAAMC,cAAa,6FAAG,2JACZC,QAAQ,CAAG,GAAIhB,OAAM,CAACiB,SAAS,CAACC,YAAY,CAACC,MAAM,CAACC,QAAQ,CAAC,uBAC5CJ,SAAQ,CAACK,IAAI,CAAC,qBAAqB,CAAE,EAAE,CAAC,QAAzDC,QAAQ,eACdhB,UAAU,CAACgB,QAAQ,CAAC,CAAC,CAAC,CAAC,uDAC1B,kBAJKP,cAAa,2CAIlB,CAEC,GAAMQ,gBAAe,6FAAG,0IACtBjB,UAAU,CAAC,EAAE,CAAC,CAAC,wDAChB,kBAFKiB,gBAAe,2CAEpB,CAEDxB,SAAS,CAAC,UAAM,CACdgB,aAAa,EAAE,CACfI,MAAM,CAACC,QAAQ,CAACI,EAAE,CAAC,iBAAiB,6FAAE,kBAAOF,QAAQ,wHACnDhB,UAAU,CAACgB,QAAQ,CAAC,CAAC,CAAC,CAAC,yDACxB,gEAAC,CACJ,CAAC,CAAE,EAAE,CAAC,CAENvB,SAAS,CAAC,UAAI,CACZ0B,OAAO,CAACC,GAAG,CAACrB,OAAO,CAAC,CACpBA,OAAO,EAAIJ,OAAO,CAACI,OAAO,CAAC,CAC1BsB,IAAI,CAAC,SAACC,IAAI,CAAG,CACVH,OAAO,CAACC,GAAG,CAACE,IAAI,CAAC,CACjBlB,OAAO,CAACkB,IAAI,CAACnB,IAAI,CAAC,CAClBD,SAAS,CAACoB,IAAI,CAACC,SAAS,CAAC,CAC7B,CAAC,CAAC,CACJ,CAAC,CAAE,CAACxB,OAAO,CAAC,CAAC,CAGf,mBACI,KAAC,WAAW,CAAC,QAAQ,EAAC,KAAK,CAAE,CAACA,OAAO,CAAPA,OAAO,CAAEU,aAAa,CAAbA,aAAa,CAAEQ,eAAe,CAAfA,eAAe,CAAEhB,MAAM,CAANA,MAAM,CAAEC,SAAS,CAATA,SAAS,CAAEC,IAAI,CAAJA,IAAI,CAAEC,OAAO,CAAPA,OAAO,CAAEC,IAAI,CAAJA,IAAI,CAAEC,OAAO,CAAPA,OAAO,CAAEC,OAAO,CAAPA,OAAO,CAAEC,UAAU,CAAVA,UAAU,CAAE,UACxIV,QAAQ,EACU,CAE/B"},"metadata":{},"sourceType":"module","externalDependencies":[]}