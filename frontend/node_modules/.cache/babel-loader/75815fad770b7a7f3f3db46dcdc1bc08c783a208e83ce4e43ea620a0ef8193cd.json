{"ast":null,"code":"import _defineProperty from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _regeneratorRuntime from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{NFTStorage,File,Blob}from\"nft.storage\";import axios from\"axios\";import{v4}from\"uuid\";export var endPoint=\"http://localhost:2000\";export var nftStorageEndPoint=\"https://nftstorage.link/ipfs\";function uploadToServer(_x,_x2,_x3){return _uploadToServer.apply(this,arguments);}function _uploadToServer(){_uploadToServer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(ipfsUrl,wallet_address,title){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(endPoint,\"/create-vault\"),{method:\"POST\",body:JSON.stringify({controller:wallet_address,ipfsUrl:ipfsUrl,mediaTitle:title}),headers:{\"content-type\":\"application/json\"}});case 3:res=_context.sent;return _context.abrupt(\"return\",res.status);case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);throw _context.t0;case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return _uploadToServer.apply(this,arguments);}var API_KEY=process.env.NFT_STORAGE_API_KEY||\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkaWQ6ZXRocjoweGE5M0I4NGFlNThkMDNkOTAwQjc5MzExOGEzNDQ2ZEZCZUU5NTVERmEiLCJpc3MiOiJuZnQtc3RvcmFnZSIsImlhdCI6MTY1MTUxMDYyMDg2MCwibmFtZSI6IlNUUiAtIE1hcmtldHBsYWNlICJ9.D71kmGtnh1wOLBF2BfVqMtuCPk79wvEiFxuhpuKgqwA\";var client=new NFTStorage({token:API_KEY});function createMetadata(_x4){return _createMetadata.apply(this,arguments);}function _createMetadata(){_createMetadata=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(image){var url,res,blob,content,cid;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;url=URL.createObjectURL(image);_context2.next=4;return fetch(url);case 4:res=_context2.sent;_context2.next=7;return res.blob();case 7:blob=_context2.sent;content=new File([image],v4()+\".\"+blob.type.split(\"/\")[1]);_context2.next=11;return client.storeBlob(content);case 11:cid=_context2.sent;console.log(\"this is the image cid \",\"https://nftstorage.link/ipfs/\"+cid);return _context2.abrupt(\"return\",cid);case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](0);throw _context2.t0;case 19:case\"end\":return _context2.stop();}}},_callee2,null,[[0,16]]);}));return _createMetadata.apply(this,arguments);}export function uploadToIpfsAndServer(_x5,_x6,_x7,_x8,_x9){return _uploadToIpfsAndServer.apply(this,arguments);}function _uploadToIpfsAndServer(){_uploadToIpfsAndServer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(image,name,description,wallet_address,web2){var _client$store,url,res,blob,content,baseURI;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;url=URL.createObjectURL(image);_context3.next=4;return fetch(url);case 4:res=_context3.sent;_context3.next=7;return res.blob();case 7:blob=_context3.sent;content=new File([image],v4()+\".\"+blob.type.split(\"/\")[1]);_context3.next=11;return client.store((_client$store={name:name,video:content,image:content,description:description},_defineProperty(_client$store,\"description\",description),_defineProperty(_client$store,\"collection\",name),_defineProperty(_client$store,\"web2_metadata\",web2),_client$store));case 11:baseURI=_context3.sent;console.log(baseURI);_context3.next=15;return uploadToServer(baseURI.url,wallet_address,name);case 15:return _context3.abrupt(\"return\",_context3.sent);case 18:_context3.prev=18;_context3.t0=_context3[\"catch\"](0);throw _context3.t0;case 21:case\"end\":return _context3.stop();}}},_callee3,null,[[0,18]]);}));return _uploadToIpfsAndServer.apply(this,arguments);}export function getVaults(_x10){return _getVaults.apply(this,arguments);}function _getVaults(){_getVaults=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(address){var res;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return fetch(\"\".concat(endPoint,\"/get-vaults/\").concat(address));case 3:res=_context4.sent;_context4.next=6;return res.json();case 6:res=_context4.sent;return _context4.abrupt(\"return\",res);case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](0);throw _context4.t0;case 13:case\"end\":return _context4.stop();}}},_callee4,null,[[0,10]]);}));return _getVaults.apply(this,arguments);}export function parseUrl(link,neg){link=link.replace(\"ipfs://\",\"\");if(neg)return link;return nftStorageEndPoint+\"/\"+link;}export function getMetadata(_x11,_x12){return _getMetadata.apply(this,arguments);}function _getMetadata(){_getMetadata=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(link,id){var res,res2;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;link=link.replace(\"ipfs://\",\"\");link=nftStorageEndPoint+\"/\"+link;_context5.next=5;return axios(link);case 5:res=_context5.sent;if(!id){_context5.next=10;break;}_context5.next=9;return axios(\"\".concat(endPoint,\"/metadata/\").concat(id));case 9:res2=_context5.sent;case 10:return _context5.abrupt(\"return\",id?res2.data:res.data);case 13:_context5.prev=13;_context5.t0=_context5[\"catch\"](0);throw _context5.t0;case 16:case\"end\":return _context5.stop();}}},_callee5,null,[[0,13]]);}));return _getMetadata.apply(this,arguments);}export function getUser(_x13){return _getUser.apply(this,arguments);}function _getUser(){_getUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(addr){var res;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return axios(\"\".concat(endPoint,\"/get-user/\").concat(addr));case 3:res=_context6.sent;if(!(res.status!=200)){_context6.next=6;break;}throw\"error\";case 6:return _context6.abrupt(\"return\",res.data);case 9:_context6.prev=9;_context6.t0=_context6[\"catch\"](0);throw _context6.t0;case 12:case\"end\":return _context6.stop();}}},_callee6,null,[[0,9]]);}));return _getUser.apply(this,arguments);}export function saveWhiteList(_x14,_x15){return _saveWhiteList.apply(this,arguments);}function _saveWhiteList(){_saveWhiteList=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(whitelist,addr){var res;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return fetch(\"\".concat(endPoint,\"/edit-user/\").concat(addr),{method:\"POST\",body:JSON.stringify(whitelist),headers:{\"content-type\":\"application/json\"}});case 3:res=_context7.sent;if(!(res.status!=200)){_context7.next=6;break;}throw\"error\";case 6:_context7.next=8;return res.json();case 8:return _context7.abrupt(\"return\",_context7.sent);case 11:_context7.prev=11;_context7.t0=_context7[\"catch\"](0);throw _context7.t0;case 14:case\"end\":return _context7.stop();}}},_callee7,null,[[0,11]]);}));return _saveWhiteList.apply(this,arguments);}","map":{"version":3,"names":["NFTStorage","File","Blob","axios","v4","endPoint","nftStorageEndPoint","uploadToServer","ipfsUrl","wallet_address","title","fetch","method","body","JSON","stringify","controller","mediaTitle","headers","res","status","API_KEY","process","env","NFT_STORAGE_API_KEY","client","token","createMetadata","image","url","URL","createObjectURL","blob","content","type","split","storeBlob","cid","console","log","uploadToIpfsAndServer","name","description","web2","store","video","baseURI","getVaults","address","json","parseUrl","link","neg","replace","getMetadata","id","res2","data","getUser","addr","saveWhiteList","whitelist"],"sources":["/Users/macbook/Desktop/BlockChain Projects/Hackerthon/frontend/src/api/api.js"],"sourcesContent":["import { NFTStorage, File, Blob } from \"nft.storage\";\nimport axios from \"axios\";\nimport { v4 } from \"uuid\";\n\nexport const endPoint = \"http://localhost:2000\";\nexport const nftStorageEndPoint = \"https://nftstorage.link/ipfs\";\n\nasync function uploadToServer(ipfsUrl, wallet_address, title) {\n  try {\n    let res = await fetch(`${endPoint}/create-vault`, {\n      method: \"POST\",\n      body: JSON.stringify({\n        controller: wallet_address,\n        ipfsUrl,\n        mediaTitle: title,\n      }),\n      headers: {\n        \"content-type\": \"application/json\",\n      },\n    });\n\n    return res.status;\n  } catch (error) {\n    throw error;\n  }\n}\n\nconst API_KEY =\n  process.env.NFT_STORAGE_API_KEY ||\n  \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkaWQ6ZXRocjoweGE5M0I4NGFlNThkMDNkOTAwQjc5MzExOGEzNDQ2ZEZCZUU5NTVERmEiLCJpc3MiOiJuZnQtc3RvcmFnZSIsImlhdCI6MTY1MTUxMDYyMDg2MCwibmFtZSI6IlNUUiAtIE1hcmtldHBsYWNlICJ9.D71kmGtnh1wOLBF2BfVqMtuCPk79wvEiFxuhpuKgqwA\";\nconst client = new NFTStorage({ token: API_KEY });\n\nasync function createMetadata(image) {\n  try {\n    let url = URL.createObjectURL(image);\n    let res = await fetch(url);\n    let blob = await res.blob();\n    const content = new File([image], v4() + \".\" + blob.type.split(\"/\")[1]);\n    const cid = await client.storeBlob(content);\n    console.log(\n      \"this is the image cid \",\n      \"https://nftstorage.link/ipfs/\" + cid\n    );\n    return cid;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport async function uploadToIpfsAndServer(\n  image,\n  name,\n  description,\n  wallet_address,\n  web2\n) {\n  try {\n    let url = URL.createObjectURL(image);\n    let res = await fetch(url);\n    let blob = await res.blob();\n    const content = new File([image], v4() + \".\" + blob.type.split(\"/\")[1]);\n\n    const baseURI = await client.store({\n      name,\n      video: content,\n      image: content,\n      description,\n      description,\n      collection: name,\n      web2_metadata: web2,\n    });\n    console.log(baseURI);\n    return await uploadToServer(baseURI.url, wallet_address, name);\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport async function getVaults(address) {\n  try {\n    let res = await fetch(`${endPoint}/get-vaults/${address}`);\n    // if(res.status != 200 || res.status != 201) throw(res);\n    res = await res.json();\n    return res;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport function parseUrl(link, neg) {\n  link = link.replace(\"ipfs://\", \"\");\n  if (neg) return link;\n  return nftStorageEndPoint + \"/\" + link;\n}\n\nexport async function getMetadata(link, id) {\n  try {\n    link = link.replace(\"ipfs://\", \"\");\n    link = nftStorageEndPoint + \"/\" + link;\n    let res = await axios(link);\n    let res2;\n    if (id) {\n      res2 = await axios(`${endPoint}/metadata/${id}`);\n    }\n    return id ? res2.data : res.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport async function getUser(addr) {\n  try {\n    let res = await axios(`${endPoint}/get-user/${addr}`);\n    if (res.status != 200) {\n      throw \"error\";\n    }\n    return res.data;\n  } catch (error) {\n    throw error;\n  }\n}\n\nexport async function saveWhiteList(whitelist, addr) {\n  try {\n    let res = await fetch(`${endPoint}/edit-user/${addr}`, {\n      method: \"POST\",\n      body: JSON.stringify(whitelist),\n      headers: {\n        \"content-type\": \"application/json\",\n      },\n    });\n    if(res.status != 200) throw(\"error\");\n    return await res.json();\n  } catch (error) {\n    throw error;\n  }\n}\n"],"mappings":"8cAAA,OAASA,UAAU,CAAEC,IAAI,CAAEC,IAAI,KAAQ,aAAa,CACpD,MAAOC,MAAK,KAAM,OAAO,CACzB,OAASC,EAAE,KAAQ,MAAM,CAEzB,MAAO,IAAMC,SAAQ,CAAG,uBAAuB,CAC/C,MAAO,IAAMC,mBAAkB,CAAG,8BAA8B,CAAC,QAElDC,eAAc,gKAA7B,iBAA8BC,OAAO,CAAEC,cAAc,CAAEC,KAAK,kKAExCC,MAAK,WAAIN,QAAQ,kBAAiB,CAChDO,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBC,UAAU,CAAEP,cAAc,CAC1BD,OAAO,CAAPA,OAAO,CACPS,UAAU,CAAEP,KACd,CAAC,CAAC,CACFQ,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QAVEC,GAAG,+CAYAA,GAAG,CAACC,MAAM,gJAIpB,iDAED,GAAMC,QAAO,CACXC,OAAO,CAACC,GAAG,CAACC,mBAAmB,EAC/B,+PAA+P,CACjQ,GAAMC,OAAM,CAAG,GAAIzB,WAAU,CAAC,CAAE0B,KAAK,CAAEL,OAAQ,CAAC,CAAC,CAAC,QAEnCM,eAAc,yJAA7B,kBAA8BC,KAAK,sKAE3BC,GAAG,CAAGC,GAAG,CAACC,eAAe,CAACH,KAAK,CAAC,wBACpBjB,MAAK,CAACkB,GAAG,CAAC,QAAtBV,GAAG,uCACUA,IAAG,CAACa,IAAI,EAAE,QAAvBA,IAAI,gBACFC,OAAO,CAAG,GAAIhC,KAAI,CAAC,CAAC2B,KAAK,CAAC,CAAExB,EAAE,EAAE,CAAG,GAAG,CAAG4B,IAAI,CAACE,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,yBACrDV,OAAM,CAACW,SAAS,CAACH,OAAO,CAAC,SAArCI,GAAG,gBACTC,OAAO,CAACC,GAAG,CACT,wBAAwB,CACxB,+BAA+B,CAAGF,GAAG,CACtC,CAAC,iCACKA,GAAG,yJAIb,iDAED,eAAsBG,sBAAqB,2EA2B1C,mHA3BM,kBACLZ,KAAK,CACLa,IAAI,CACJC,WAAW,CACXjC,cAAc,CACdkC,IAAI,wLAGEd,GAAG,CAAGC,GAAG,CAACC,eAAe,CAACH,KAAK,CAAC,wBACpBjB,MAAK,CAACkB,GAAG,CAAC,QAAtBV,GAAG,uCACUA,IAAG,CAACa,IAAI,EAAE,QAAvBA,IAAI,gBACFC,OAAO,CAAG,GAAIhC,KAAI,CAAC,CAAC2B,KAAK,CAAC,CAAExB,EAAE,EAAE,CAAG,GAAG,CAAG4B,IAAI,CAACE,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,yBAEjDV,OAAM,CAACmB,KAAK,iBAChCH,IAAI,CAAJA,IAAI,CACJI,KAAK,CAAEZ,OAAO,CACdL,KAAK,CAAEK,OAAO,CACdS,WAAW,CAAXA,WAAW,8CACXA,WAAW,6CACCD,IAAI,gDACDE,IAAI,iBACnB,SARIG,OAAO,gBASbR,OAAO,CAACC,GAAG,CAACO,OAAO,CAAC,CAAC,wBACRvC,eAAc,CAACuC,OAAO,CAACjB,GAAG,CAAEpB,cAAc,CAAEgC,IAAI,CAAC,iNAIjE,wDAED,eAAsBM,UAAS,gDAS9B,2FATM,kBAAyBC,OAAO,wKAEnBrC,MAAK,WAAIN,QAAQ,wBAAe2C,OAAO,EAAG,QAAtD7B,GAAG,uCAEKA,IAAG,CAAC8B,IAAI,EAAE,QAAtB9B,GAAG,iDACIA,GAAG,yJAIb,4CAED,MAAO,SAAS+B,SAAQ,CAACC,IAAI,CAAEC,GAAG,CAAE,CAClCD,IAAI,CAAGA,IAAI,CAACE,OAAO,CAAC,SAAS,CAAE,EAAE,CAAC,CAClC,GAAID,GAAG,CAAE,MAAOD,KAAI,CACpB,MAAO7C,mBAAkB,CAAG,GAAG,CAAG6C,IAAI,CACxC,CAEA,eAAsBG,YAAW,uDAahC,+FAbM,kBAA2BH,IAAI,CAAEI,EAAE,sJAEtCJ,IAAI,CAAGA,IAAI,CAACE,OAAO,CAAC,SAAS,CAAE,EAAE,CAAC,CAClCF,IAAI,CAAG7C,kBAAkB,CAAG,GAAG,CAAG6C,IAAI,CAAC,uBACvBhD,MAAK,CAACgD,IAAI,CAAC,QAAvBhC,GAAG,oBAEHoC,EAAE,kDACSpD,MAAK,WAAIE,QAAQ,sBAAakD,EAAE,EAAG,QAAhDC,IAAI,yDAECD,EAAE,CAAGC,IAAI,CAACC,IAAI,CAAGtC,GAAG,CAACsC,IAAI,yJAInC,8CAED,eAAsBC,QAAO,8CAU5B,uFAVM,kBAAuBC,IAAI,wKAEdxD,MAAK,WAAIE,QAAQ,sBAAasD,IAAI,EAAG,QAAjDxC,GAAG,qBACHA,GAAG,CAACC,MAAM,EAAI,GAAG,gCACb,OAAO,yCAERD,GAAG,CAACsC,IAAI,sJAIlB,0CAED,eAAsBG,cAAa,yDAclC,mGAdM,kBAA6BC,SAAS,CAAEF,IAAI,wKAE/BhD,MAAK,WAAIN,QAAQ,uBAAcsD,IAAI,EAAI,CACrD/C,MAAM,CAAE,MAAM,CACdC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC8C,SAAS,CAAC,CAC/B3C,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CACF,CAAC,CAAC,QANEC,GAAG,qBAOJA,GAAG,CAACC,MAAM,EAAI,GAAG,gCAAQ,OAAO,+BACtBD,IAAG,CAAC8B,IAAI,EAAE,gNAI1B"},"metadata":{},"sourceType":"module","externalDependencies":[]}